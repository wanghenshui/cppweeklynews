---
layout: post
title:  第87期
---
# C++ 中文周刊 第87期


从[reddit](https://www.reddit.com/r/cpp/)/[hackernews](https://news.ycombinator.com/)/[lobsters](https://lobste.rs/)/[meetingcpp](https://www.meetingcpp.com/blog/blogroll/)/[purecpp](http://www.purecpp.cn/)/知乎/等等摘抄一些c++动态

`TODO fix meetingcpp blogroll link`

[周刊项目地址](https://github.com/wanghenshui/cppweeklynews)

公众号

<img src="https://wanghenshui.github.io/cppweeklynews/assets/code.png" alt=""  width="30%">

弄了个qq频道，[手机qq点击进入](https://qun.qq.com/qqweb/qunpro/share?_wv=3&_wwv=128&inviteCode=xzjHQ&from=246610&biz=ka)

欢迎投稿，推荐或自荐文章/软件/资源等


可以贴在下一期草稿里 [草稿链接](https://github.com/wanghenshui/cppweeklynews/pull/20)

`TODO update date here`

---

## 资讯

标准委员会动态/ide/编译器信息放在这里

[编译器信息最新动态推荐关注hellogcc公众号 本周更新 2022-01-05 第131期](https://github.com/hellogcc/osdt-weekly/blob/master/weekly-2022/2022-01-05.md)

`TODO fix link then remove this line`

## 文章

- [静态分析优化代码分支性能](https://zhuanlan.zhihu.com/p/578791924)

涨涨见识

- [Lock-Free 班门弄斧(Hazard Pointer)](https://zhuanlan.zhihu.com/p/576073971)
  
看个乐

- [C++ 一个偶现的内存破坏](https://zhuanlan.zhihu.com/p/578290634)

老生常谈的`string.data()`生命周期问题

-  [记一次CLOSE_WAIT引发的血案](https://zhuanlan.zhihu.com/p/578699402)

连接有增有降但是 socket却一直上涨？  忘记close？

```bash
ss -tna|grep $PORT|grep CLOSE
```

当然配置SO_KEEPALIVE就可以了

```c
int val = 600; 
if (setsockopt(client_fd, IPPROTO_TCP, TCP_KEEPIDLE, &val, sizeof(val)) < 0) { ... }     
val = 5; 
if (setsockopt(cliend_fd, IPPROTO_TCP, TCP_KEEPINTVL, &val, sizeof(val)) < 0) { ... }     
val = 3; 
if (setsockopt(, IPPROTO_TCP, TCP_KEEPCNT, &val, sizeof(val)) < 0) { ... }

```
- [Did you now that with concepts you can override a type? ](https://github.com/QuantlabFinancial/cpp_tip_of_the_week/blob/master/tips/302.md)

```cpp
template<auto N> struct foo  {
  static constexpr auto value = N;
};
static_assert(42 == foo<42>::value);

template<auto N>
  requires true // override -> more specialized
struct foo<N> {
  static constexpr auto value = 0;
};
static_assert(42 == foo<42>::value); // memoized
static_assert(0 == foo<43>::value);
```

更简单的特化，可以玩一些骚的，比如，特化`shared_ptr<int>`,让它退化成local模式，（不要线程安全, `boost::local_shared_ptr`）

```cpp
namespace std {
template <class T>
    requires std::is_integral_v<T>
class shared_ptr<T> : public __shared_ptr<int, __gnu_cxx::_S_single> {};
}  // namespace std
```
注意特化标准库中的组件是UB，这里只是秀一下 

- [Bringing a dynamic environment to C: My linker project](https://macoy.me/blog/programming/LinkerLoaderIntro)
  
  写linker从哪里开始做起？

## 视频

- [C++ Weekly ](https://www.youtube.com/channel/UCxHAlbZQNFU2LgEtiqd2Maw)

`TODO fix link then remove this line`

## 开源项目需要人手

- [asteria](https://github.com/lhmouse/asteria) 一个脚本语言，可嵌入，长期找人，希望胖友们帮帮忙，也可以加群384042845和作者对线
- [pika](https://github.com/OpenAtomFoundation/pika) 一个nosql 存储， redis over rocksdb，非常需要人贡献代码胖友们， 感兴趣的欢迎加群294254078前来对线

## 新项目介绍/版本更新
- boost 1.81的`boost::unordered_flat_map`效果不错
## 工作招聘

---

看到这里或许你有建议或者疑问或者指出错误，请留言评论! 多谢!  你的评论非常重要！也可以帮忙点赞收藏转发！多谢支持！

[本文永久链接](https://wanghenshui.github.io/cppweeklynews/posts/087.html)
